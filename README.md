# LLM-Explanations-for-Radiology

Code for the paper "The effect of medical explanations from large language models on diagnostic decisions in radiology."

## Authors and contact

Philipp Spitzer, Daniel Hendriks, Sarah Schlaeger, Jan Rudolph, Jens Ricke, Niklas Kühl, Boj Friedrich Hoppe, and Stefan Feuerriegel.

Correspondence to: spitzer@kit.edu & feuerriegel@lmu.de

## Project Description

In our large-scale randomized study, we investigated the impact of different explanation formats generated by large language models (LLMs) on radiologists’ diagnostic accuracy. We found that chain-of-thought explanations, which provide a detailed reasoning process for the diagnosis, significantly improved diagnostic performance compared to no LLM support, standard output without explanation, and differential diagnosis formats. Our results underscore the importance of designing LLM explanations that effectively support physicians’ reasoning processes to enhance diagnostic accuracy and potentially improve patient outcomes.


## Contents
- Data/: Directory containing the data files used in the project.
  - `adherence_summary.xlsx`: Evaluation results of adherence to diagnoses recommendations.
  - `adherence_eval_dd-top5.xlsx`: Evaluation results of adherence to differential diagnoses options.
  - Cases/: Subdirectory containing case images.
  - `Claude_output_reviews.xlsx`: Evaluation results of Claude-generated diagnoses.
  - `data_evaluated.xlsx`: Preprocessed survey data.
  - `judgement_rad.xlsx`: Evaluation of participants' answers.
  - `LLM_output_reviews.xlsx`: Evaluation of GPT-4 generated diagnoses.
  - `raw_data.xlsx`: Raw data from Qualtrics survey.
- Notebooks/: Directory containing Jupyter notebooks and utility files.
  - `01_preprocessing.ipynb`: Preprocessing of raw survey data.
  - `02_testing_and_regression.ipynb`: Statistical analysis notebook.
  - `environment.yml`: Environment configuration file.
  - `style.mplstyle`: Figure styling configuration.
  - `utils.py`: Analysis and visualization utilities.
- Results/: Directory containing output files.
  - Plots/: Generated visualizations.
  - Tex/: TeX files for publication.
- Survey/: Survey materials.
  - `LLMs_in_Medicine.qsf`: Qualtrics survey file.

## Usage
To set up the required environment:

1. Install conda or miniconda if not already installed
2. Clone this repository
3. Navigate to the repository directory
4. Create and activate the environment using:
   ```
   conda env create -f Notebooks/environment.yml
   conda activate llm-radiology
   ```
5. Run notebook `02_testing_and_regression.ipynb` to reproduce statistical analyses and figures from our paper.
